<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Clerk User Info</title>
  <script async crossorigin="anonymous" data-clerk-publishable-key="pk_live_Y2xlcmsub2xpdmVydHJpdW5mby5jb20k" src="https://clerk.olivertriunfo.com/npm/@clerk/clerk-js@latest/dist/clerk.browser.js"></script>
</head>
<body>
  <h1>Clerk Session Viewer</h1>

  <div id="status">Loading...</div>
  <pre id="userInfo"></pre>

  <div id="authButtons" style="margin-top: 20px;">
    <button id="signInBtn">Sign In</button>
    <button id="signOutBtn" style="display:none;">Sign Out</button>
  </div>

  <script>
    window.addEventListener("load", async () => {
      // Wait for Clerk to be ready
      await window.Clerk.load();

      const user = window.Clerk.user;

      async function refreshUserInfo() {
        if (user) {
          const email = user.primaryEmailAddress?.emailAddress;
          const name = `${user.firstName || ''} ${user.lastName || ''}`.trim();

          document.getElementById("status").textContent = "User is signed in:";
          document.getElementById("userInfo").textContent = JSON.stringify({
            id: user.id,
            email,
            name,
            username: user.username
          }, null, 2);

          document.getElementById("signOutBtn").style.display = "inline-block";
          document.getElementById("signInBtn").style.display = "none";
        } else {
          document.getElementById("status").textContent = "No user is signed in.";
          document.getElementById("userInfo").textContent = "";
          document.getElementById("signOutBtn").style.display = "none";
          document.getElementById("signInBtn").style.display = "inline-block";
        }
      }

      // Mount sign-in handler
      document.getElementById("signInBtn").addEventListener("click", () => {
        window.Clerk.openSignIn({
          redirectUrl: window.location.href
        });
      });

      // Sign-out handler
      document.getElementById("signOutBtn").addEventListener("click", async () => {
        await window.Clerk.signOut();
        window.location.reload();
      });

      refreshUserInfo();
    });
  </script>
</body>
</html>
